#!/bin/bash

base='profiles'
#  See: http://svn.delph-in.net/erg/tags/1214/etc/redwoods.xls
#  + -> train
#  = -> dev
#  ? -> test
testsuites=(
  "+csli"
  "+esd"
  "+fracas"
  "+mrs"
  "+trec"

  "?cb"
  "+ecoc"
  "+ecos"
  "=ecpa"
  "?ecpr"

  "+hike"
  "+jh0"
  "+jh1"
  "+jh2"
  "+jh3"
  "+jh4"
  "=jh5"
  "?jhk"
  "?jhu"
  "+tg1"
  "=tg2"
  "?tgk"
  "?tgu"
  "+ps"
  "?psk"
  "?psu"
  "?rondane"

  "+rtc000"
  "+rtc001"

  "+sc01"
  "+sc02"
  "+sc03"

  "?cf04"
  "?cf06"
  "?cf10"
  "?cf21"
  "?cg07"
  "?cg11"
  "?cg21"
  "?cg25"
  "?cg32"
  "?cg35"
  "?ck11"
  "?ck17"
  "?cl05"
  "?cl14"
  "?cm04"
  "?cn03"
  "?cn10"
  "?cp15"
  "?cp26"
  "?cr09"

  "+vm6"
  "+vm13"
  "+vm31"
  "?vm32"

  "+ws01"
  "+ws02"
  "+ws03"
  "+ws04"
  "+ws05"
  "+ws06"
  "+ws07"
  "+ws08"
  "+ws09"
  "+ws10"
  "+ws11"
  "=ws12"
  "?ws13"
  "?ws214"

  "+peted"
  "?petet"

  "+wsj00a"
  "+wsj00b"
  "+wsj00c"
  "+wsj00d"
  "+wsj01a"
  "+wsj01b"
  "+wsj01c"
  "+wsj01d"
  "+wsj02a"
  "+wsj02b"
  "+wsj02c"
  "+wsj02d"
  "+wsj03a"
  "+wsj03b"
  "+wsj03c"
  "+wsj04a"
  "+wsj04b"
  "+wsj04c"
  "+wsj04d"
  "+wsj04e"
  "+wsj05a"
  "+wsj05b"
  "+wsj05c"
  "+wsj05d"
  "+wsj05e"
  "+wsj06a"
  "+wsj06b"
  "+wsj06c"
  "+wsj06d"
  "+wsj07a"
  "+wsj07b"
  "+wsj07c"
  "+wsj07d"
  "+wsj07e"
  "+wsj08a"
  "+wsj09a"
  "+wsj09b"
  "+wsj09c"
  "+wsj09d"
  "+wsj09e"
  "+wsj10a"
  "+wsj10b"
  "+wsj10c"
  "+wsj10d"
  "+wsj11a"
  "+wsj11b"
  "+wsj11c"
  "+wsj11d"
  "+wsj11e"
  "+wsj12a"
  "+wsj12b"
  "+wsj12c"
  "+wsj12d"
  "+wsj12e"
  "+wsj13a"
  "+wsj13b"
  "+wsj13c"
  "+wsj13d"
  "+wsj13e"
  "+wsj14a"
  "+wsj14b"
  "+wsj14c"
  "+wsj14d"
  "+wsj14e"
  "+wsj15a"
  "+wsj15b"
  "+wsj15c"
  "+wsj15d"
  "+wsj15e"
  "+wsj16a"
  "+wsj16b"
  "+wsj16c"
  "+wsj16d"
  "+wsj16e"
  "+wsj16f"
  "+wsj17a"
  "+wsj17b"
  "+wsj17c"
  "+wsj17d"
  "+wsj18a"
  "+wsj18b"
  "+wsj18c"
  "+wsj18d"
  "+wsj18e"
  "+wsj19a"
  "+wsj19b"
  "+wsj19c"
  "+wsj19d"
  "=wsj20a"
  "=wsj20b"
  "=wsj20c"
  "=wsj20d"
  "=wsj20e"
  "?wsj21a"
  "?wsj21b"
  "?wsj21c"
  "?wsj21d"
)

mkdir -p out/{train,dev,test}
for ts in ${testsuites[*]}; do
    prefix="${ts:0:1}"
    name="${ts:1}"
    case "$prefix" in
      "+") outpath="out/train/${name}.txt"; errpath="out/train/${name}.err" ;;
      "=") outpath="out/dev/${name}.txt"  ; errpath="out/dev/${name}.err" ;;
      "?") outpath="out/test/${name}.txt" ; errpath="out/test/${name}.err" ;;
      *)
        echo "Testsuite not designated as train (+), dev (=) or test (?): $ts"
        exit 1
        ;;
    esac
    echo "Converting $base/$name" >&2
    python3 mrs_to_penman.py \
        -i "$base/$name" \
        -p parameters.json \
        > "$outpath" 2> "$errpath"
done
